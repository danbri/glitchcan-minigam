<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>RetroSpec ZX</title>
  <style>
    :root {
      --primary-color: #00caff;
      --secondary-color: #ff4d88;
      --background-color: #111;
      --text-color: #eee;
      --tape-color: #ffcc00;
      --pixel-size: 4px;
    }
    
    * {
      box-sizing: border-box;
      touch-action: manipulation;
    }
    
    body {
      background: var(--background-color);
      color: var(--text-color);
      font-family: 'Courier New', monospace;
      margin: 0;
      padding: 0;
      overflow: hidden;
      height: 100vh;
      width: 100vw;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    #computer {
      position: relative;
      width: 100%;
      max-width: 800px;
      margin: 1em auto;
      padding: 1em;
      background: #222;
      border-radius: 10px;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5), inset 0 0 10px rgba(255, 255, 255, 0.1);
    }
    
    #screen-container {
      position: relative;
      width: 100%;
      padding-bottom: 75%; /* 4:3 aspect ratio */
      margin-bottom: 1em;
      border: 10px solid #333;
      border-radius: 10px;
      background: #000;
      overflow: hidden;
    }
    
    #screen {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      overflow: hidden;
      background: #000;
    }
    
    #screen-content {
      position: relative;
      width: 100%;
      height: 100%;
    }
    
    /* CRT Effect */
    .crt-effect {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      background: linear-gradient(
        to bottom,
        rgba(255, 255, 255, 0.15) 0%,
        rgba(255, 255, 255, 0) 50%,
        rgba(255, 255, 255, 0.15) 100%
      );
      opacity: 0.3;
      z-index: 20;
    }
    
    .scanlines {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: repeating-linear-gradient(
        to bottom,
        transparent 0px,
        transparent 1px,
        rgba(0, 0, 0, 0.3) 1px,
        rgba(0, 0, 0, 0.3) 2px
      );
      pointer-events: none;
      z-index: 21;
    }
    
    /* Controls */
    #controls {
      display: flex;
      justify-content: space-between;
      width: 100%;
      padding: 0.5em;
      flex-wrap: wrap;
    }
    
    .control-group {
      display: flex;
      gap: 0.5em;
      margin-bottom: 0.5em;
    }
    
    button {
      background: #333;
      color: var(--text-color);
      border: none;
      padding: 0.5em 1em;
      border-radius: 4px;
      font-family: inherit;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    button:hover {
      background: #444;
    }
    
    button:active {
      transform: translateY(2px);
    }
    
    button.highlighted {
      background: var(--primary-color);
      color: #000;
    }
    
    /* Tape Loading Screen */
    #loading-screen {
      position: absolute;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background: #000;
      z-index: 10;
      color: var(--primary-color);
      text-align: center;
    }
    
    #loading-border {
      width: 80%;
      height: 80%;
      border: 16px solid var(--primary-color);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
    
    .loading-title {
      font-size: 2em;
      margin-bottom: 1em;
      text-transform: uppercase;
    }
    
    .loading-message {
      font-size: 1.2em;
      margin-bottom: 1em;
    }
    
    #loading-progress {
      width: 80%;
      height: 20px;
      border: 2px solid var(--primary-color);
      margin-top: 1em;
    }
    
    #progress-bar {
      height: 100%;
      width: 0%;
      background: var(--primary-color);
      transition: width 0.2s;
    }
    
    /* Cassette Selector */
    #cassette-container {
      position: relative;
      width: 100%;
      max-width: 800px;
      height: 200px;
      overflow-x: auto;
      overflow-y: hidden;
      white-space: nowrap;
      padding: 1em 0;
      margin-top: 1em;
      -webkit-overflow-scrolling: touch;
    }
    
    .cassette {
      display: inline-block;
      width: 160px;
      height: 100px;
      margin: 0 1em;
      background: var(--tape-color);
      border-radius: 5px;
      position: relative;
      padding: 0.5em;
      text-align: center;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      cursor: pointer;
      transition: transform 0.2s;
      vertical-align: top;
    }
    
    .cassette:hover {
      transform: translateY(-5px);
    }
    
    .cassette::before {
      content: '';
      position: absolute;
      top: 30px;
      left: 20px;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: #333;
      box-shadow: 80px 0 0 #333;
    }
    
    .cassette-title {
      position: absolute;
      bottom: 10px;
      left: 0;
      width: 100%;
      text-align: center;
      font-size: 0.8em;
      color: #000;
      font-weight: bold;
    }
    
    /* ZX Font */
    .zx-font {
      font-family: 'Courier New', monospace;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-weight: bold;
    }
    
    /* Game Selector Screen */
    #game-selector {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      color: var(--primary-color);
      background: #000;
      padding: 2em;
      overflow: auto;
      z-index: 9;
    }
    
    #game-selector.hidden {
      display: none;
    }
    
    .selector-title {
      text-align: center;
      margin-bottom: 1em;
      font-size: 1.5em;
      text-shadow: 0 0 5px var(--primary-color);
      border-bottom: 1px solid var(--primary-color);
      padding-bottom: 0.5em;
    }
    
    .game-list {
      list-style-type: none;
      padding: 0;
    }
    
    .game-item {
      padding: 0.5em;
      margin-bottom: 0.5em;
      border: 1px solid var(--primary-color);
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .game-item:hover, .game-item.selected {
      background: var(--primary-color);
      color: #000;
    }
    
    .game-title {
      font-weight: bold;
    }
    
    .game-details {
      font-size: 0.8em;
      opacity: 0.8;
    }
    
    /* Pixel Art Canvas */
    #pixel-canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: grid;
      grid-template-columns: repeat(64, var(--pixel-size));
      grid-template-rows: repeat(48, var(--pixel-size));
      z-index: 5;
    }
    
    .pixel {
      width: var(--pixel-size);
      height: var(--pixel-size);
    }
    
    /* Small screen adjustments */
    @media (max-width: 600px) {
      :root {
        --pixel-size: 3px;
      }
      
      #controls {
        flex-direction: column;
      }
      
      .control-group {
        justify-content: center;
      }
      
      button {
        padding: 0.3em 0.6em;
        font-size: 0.9em;
      }
    }
    
    .hidden {
      display: none !important;
    }
    
    /* Basic ZX Spectrum colors */
    .zx-black { background-color: #000000; }
    .zx-blue { background-color: #0000d7; }
    .zx-red { background-color: #d70000; }
    .zx-magenta { background-color: #d700d7; }
    .zx-green { background-color: #00d700; }
    .zx-cyan { background-color: #00d7d7; }
    .zx-yellow { background-color: #d7d700; }
    .zx-white { background-color: #d7d7d7; }
    .zx-bright-black { background-color: #000000; }
    .zx-bright-blue { background-color: #0000ff; }
    .zx-bright-red { background-color: #ff0000; }
    .zx-bright-magenta { background-color: #ff00ff; }
    .zx-bright-green { background-color: #00ff00; }
    .zx-bright-cyan { background-color: #00ffff; }
    .zx-bright-yellow { background-color: #ffff00; }
    .zx-bright-white { background-color: #ffffff; }
  </style>
</head>
<body>
  <div id="computer">
    <div id="screen-container">
      <div id="screen">
        <div id="screen-content">
          <!-- Loading screen -->
          <div id="loading-screen">
            <div id="loading-border">
              <div class="loading-title zx-font">RetroSpec ZX</div>
              <div class="loading-message">LOADING...</div>
              <div id="loading-progress">
                <div id="progress-bar"></div>
              </div>
            </div>
          </div>
          
          <!-- Game selector screen -->
          <div id="game-selector" class="hidden">
            <div class="selector-title zx-font">GAME SELECTION</div>
            <ul class="game-list">
              <li class="game-item" data-game="manic-miner">
                <div class="game-title">Manic Miner</div>
                <div class="game-details">Platform game • 1983 • Bug-Byte</div>
              </li>
              <li class="game-item" data-game="jet-set-willy">
                <div class="game-title">Jet Set Willy</div>
                <div class="game-details">Platform game • 1984 • Software Projects</div>
              </li>
              <li class="game-item" data-game="skool-daze">
                <div class="game-title">Skool Daze</div>
                <div class="game-details">Adventure • 1984 • Microsphere</div>
              </li>
              <li class="game-item" data-game="atic-atac">
                <div class="game-title">Atic Atac</div>
                <div class="game-details">Adventure • 1983 • Ultimate</div>
              </li>
              <li class="game-item" data-game="lords-of-midnight">
                <div class="game-title">The Lords of Midnight</div>
                <div class="game-details">Strategy/RPG • 1984 • Beyond Software</div>
              </li>
              <li class="game-item" data-game="dun-darach">
                <div class="game-title">Dun Darach</div>
                <div class="game-details">Adventure • 1985 • Gargoyle Games</div>
              </li>
              <li class="game-item" data-game="knight-lore">
                <div class="game-title">Knight Lore</div>
                <div class="game-details">Isometric adventure • 1984 • Ultimate</div>
              </li>
              <li class="game-item" data-game="the-hobbit">
                <div class="game-title">The Hobbit</div>
                <div class="game-details">Text adventure • 1982 • Melbourne House</div>
              </li>
            </ul>
          </div>
          
          <!-- Game display area -->
          <div id="game-display" class="hidden">
            <div id="pixel-canvas"></div>
          </div>
          
          <!-- Effects overlays -->
          <div class="scanlines"></div>
          <div class="crt-effect"></div>
        </div>
      </div>
    </div>
    
    <div id="controls">
      <div class="control-group">
        <button id="powerBtn">POWER</button>
        <button id="resetBtn">RESET</button>
      </div>
      <div class="control-group">
        <button id="loadBtn">LOAD</button>
        <button id="playBtn" disabled>PLAY</button>
      </div>
    </div>
  </div>
  
  <div id="cassette-container">
    <div class="cassette" data-game="jet-set-willy">
      <div class="cassette-title">Jet Set Willy</div>
    </div>
    <div class="cassette" data-game="manic-miner">
      <div class="cassette-title">Manic Miner</div>
    </div>
    <div class="cassette" data-game="knight-lore">
      <div class="cassette-title">Knight Lore</div>
    </div>
    <div class="cassette" data-game="skool-daze">
      <div class="cassette-title">Skool Daze</div>
    </div>
    <div class="cassette" data-game="the-hobbit">
      <div class="cassette-title">The Hobbit</div>
    </div>
    <div class="cassette" data-game="atic-atac">
      <div class="cassette-title">Atic Atac</div>
    </div>
  </div>
  
  <script>
    // Game/system state
    const systemState = {
      power: false,
      loading: false,
      selectedGame: null,
      loadingProgress: 0,
      loadingInterval: null
    };
    
    // DOM Elements
    const loadingScreen = document.getElementById('loading-screen');
    const gameSelector = document.getElementById('game-selector');
    const gameDisplay = document.getElementById('game-display');
    const progressBar = document.getElementById('progress-bar');
    const powerBtn = document.getElementById('powerBtn');
    const resetBtn = document.getElementById('resetBtn');
    const loadBtn = document.getElementById('loadBtn');
    const playBtn = document.getElementById('playBtn');
    const pixelCanvas = document.getElementById('pixel-canvas');
    
    // Audio elements (for ZX Spectrum loading sounds)
    const loadingSound = new Audio();
    loadingSound.loop = true;
    loadingSound.volume = 0.3;
    
    // Create loading sound dynamically with AudioContext
    function createLoadingSound() {
      try {
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        
        oscillator.type = 'square';
        oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
        
        // Set up a modulation to simulate the ZX Spectrum loading sound
        setInterval(() => {
          const randomFreq = 800 + Math.random() * 1200;
          oscillator.frequency.setValueAtTime(randomFreq, audioContext.currentTime);
        }, 200);
        
        gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
        
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        return { oscillator, gainNode, audioContext };
      } catch (e) {
        console.error("Web Audio API not supported:", e);
        return null;
      }
    }
    
    // Button event handlers
    powerBtn.addEventListener('click', togglePower);
    resetBtn.addEventListener('click', resetSystem);
    loadBtn.addEventListener('click', loadTape);
    playBtn.addEventListener('click', playGame);
    
    // Game selection handlers
    document.querySelectorAll('.game-item').forEach(item => {
      item.addEventListener('click', () => {
        selectGame(item.dataset.game);
      });
    });
    
    // Cassette selection
    document.querySelectorAll('.cassette').forEach(cassette => {
      cassette.addEventListener('click', () => {
        if (!systemState.power) togglePower();
        systemState.selectedGame = cassette.dataset.game;
        loadBtn.disabled = false;
      });
    });
    
    // Toggle power
    function togglePower() {
      systemState.power = !systemState.power;
      powerBtn.classList.toggle('highlighted', systemState.power);
      
      if (systemState.power) {
        // Power on sequence
        showScreen(loadingScreen);
        setTimeout(() => {
          showScreen(gameSelector);
        }, 2000);
      } else {
        // Power off sequence
        resetSystem();
        showScreen(loadingScreen);
        powerBtn.classList.remove('highlighted');
        loadBtn.classList.remove('highlighted');
        playBtn.classList.remove('highlighted');
        loadBtn.disabled = true;
        playBtn.disabled = true;
      }
    }
    
    // Reset the system
    function resetSystem() {
      if (!systemState.power) return;
      
      // Stop any loading
      if (systemState.loading) {
        clearInterval(systemState.loadingInterval);
        systemState.loading = false;
        loadingSound.pause();
      }
      
      // Reset UI
      loadBtn.disabled = false;
      loadBtn.classList.remove('highlighted');
      playBtn.disabled = true;
      playBtn.classList.remove('highlighted');
      
      // Go back to game selection
      showScreen(gameSelector);
    }
    
    // Load a game
    function loadTape() {
      if (!systemState.power || systemState.loading) return;
      
      systemState.loading = true;
      loadBtn.classList.add('highlighted');
      showScreen(loadingScreen);
      
      // Start loading animation
      systemState.loadingProgress = 0;
      updateProgressBar();
      
      // Create loading sound
      const audio = createLoadingSound();
      if (audio) {
        audio.oscillator.start();
      }
      
      // Simulate loading with progress
      systemState.loadingInterval = setInterval(() => {
        systemState.loadingProgress += 1;
        updateProgressBar();
        
        if (systemState.loadingProgress >= 100) {
          // Loading complete
          clearInterval(systemState.loadingInterval);
          systemState.loading = false;
          loadBtn.classList.remove('highlighted');
          playBtn.disabled = false;
          
          // Stop loading sound
          if (audio) {
            audio.oscillator.stop();
          }
        }
      }, 100);
    }
    
    // Play the loaded game
    function playGame() {
      if (!systemState.power || systemState.loading || !systemState.selectedGame) return;
      
      playBtn.classList.add('highlighted');
      showScreen(gameDisplay);
      
      // Load the appropriate game
      switch (systemState.selectedGame) {
        case 'jet-set-willy':
          loadJetSetWilly();
          break;
        case 'manic-miner':
          loadManicMiner();
          break;
        default:
          loadPlaceholder(systemState.selectedGame);
      }
    }
    
    // Select a game from the menu
    function selectGame(game) {
      systemState.selectedGame = game;
      
      // Update UI for selected game
      document.querySelectorAll('.game-item').forEach(item => {
        item.classList.toggle('selected', item.dataset.game === game);
      });
      
      loadBtn.disabled = false;
    }
    
    // Show a specific screen, hide others
    function showScreen(screenToShow) {
      [loadingScreen, gameSelector, gameDisplay].forEach(screen => {
        screen.classList.toggle('hidden', screen !== screenToShow);
      });
    }
    
    // Update the loading progress bar
    function updateProgressBar() {
      progressBar.style.width = `${systemState.loadingProgress}%`;
    }
    
    // Pixel art rendering functions
    function clearPixelCanvas() {
      pixelCanvas.innerHTML = '';
    }
    
    function createPixelGrid(width, height) {
      clearPixelCanvas();
      for (let y = 0; y < height; y++) {
        for (let x = 0; x < width; x++) {
          const pixel = document.createElement('div');
          pixel.className = 'pixel';
          pixel.id = `pixel-${x}-${y}`;
          pixelCanvas.appendChild(pixel);
        }
      }
    }
    
    function setPixel(x, y, colorClass) {
      const pixel = document.getElementById(`pixel-${x}-${y}`);
      if (pixel) {
        // Clear existing color classes
        pixel.className = 'pixel';
        if (colorClass) {
          pixel.classList.add(colorClass);
        }
      }
    }
    
    function drawRect(x, y, width, height, colorClass) {
      for (let dy = 0; dy < height; dy++) {
        for (let dx = 0; dx < width; dx++) {
          setPixel(x + dx, y + dy, colorClass);
        }
      }
    }
    
    // Simplified sample games
    function loadJetSetWilly() {
      createPixelGrid(64, 48);
      
      // Draw a basic Jet Set Willy scene
      // Background
      drawRect(0, 0, 64, 48, 'zx-black');
      
      // Floor
      drawRect(0, 40, 64, 8, 'zx-bright-blue');
      
      // Platforms
      drawRect(10, 30, 20, 2, 'zx-yellow');
      drawRect(35, 25, 20, 2, 'zx-yellow');
      drawRect(15, 15, 15, 2, 'zx-yellow');
      
      // Enemies (simplified)
      drawRect(20, 28, 2, 2, 'zx-bright-red');
      drawRect(50, 23, 2, 2, 'zx-bright-red');
      
      // Items
      drawRect(15, 13, 1, 1, 'zx-bright-white');
      drawRect(25, 13, 1, 1, 'zx-bright-white');
      drawRect(40, 23, 1, 1, 'zx-bright-white');
      
      // "Willy" character
      drawRect(5, 38, 2, 2, 'zx-bright-magenta');
    }
    
    function loadManicMiner() {
      createPixelGrid(64, 48);
      
      // Draw a basic Manic Miner scene
      // Background
      drawRect(0, 0, 64, 48, 'zx-black');
      
      // Central cavern
      drawRect(0, 40, 64, 8, 'zx-bright-cyan');
      
      // Platforms
      drawRect(5, 35, 20, 1, 'zx-bright-green');
      drawRect(30, 30, 25, 1, 'zx-bright-green');
      drawRect(10, 25, 20, 1, 'zx-bright-green');
      drawRect(35, 20, 20, 1, 'zx-bright-green');
      
      // Enemies
      drawRect(15, 33, 3, 2, 'zx-bright-yellow');
      drawRect(40, 28, 3, 2, 'zx-bright-yellow');
      drawRect(20, 23, 3, 2, 'zx-bright-yellow');
      
      // Air bar
      drawRect(2, 2, 40, 2, 'zx-bright-white');
      
      // "Miner Willy"
      drawRect(7, 33, 2, 2, 'zx-bright-red');
    }
    
    function loadPlaceholder(gameName) {
      createPixelGrid(64, 48);
      
      // Generic placeholder for other games
      // Background
      drawRect(0, 0, 64, 48, 'zx-black');
      
      // Add some random colored blocks for visual interest
      const colors = [
        'zx-blue', 'zx-red', 'zx-magenta', 'zx-green', 
        'zx-cyan', 'zx-yellow', 'zx-white',
        'zx-bright-blue', 'zx-bright-red', 'zx-bright-magenta',
        'zx-bright-green', 'zx-bright-cyan', 'zx-bright-yellow'
      ];
      
      // Generate a pseudo-random pattern based on the game name
      const seed = gameName.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
      
      for (let i = 0; i < 20; i++) {
        const x = (seed * (i + 1)) % 60;
        const y = (seed * (i * 3)) % 40;
        const w = (i % 5) + 3;
        const h = (i % 3) + 2;
        drawRect(x, y, w, h, colors[i % colors.length]);
      }
      
      // Draw a border
      for (let x = 0; x < 64; x++) {
        setPixel(x, 0, 'zx-bright-white');
        setPixel(x, 47, 'zx-bright-white');
      }
      
      for (let y = 0; y < 48; y++) {
        setPixel(0, y, 'zx-bright-white');
        setPixel(63, y, 'zx-bright-white');
      }
    }
    
    // Initialize system in power off state
    showScreen(loadingScreen);
  </script>
</body>
</html>